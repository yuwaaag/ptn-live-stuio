<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>PTN NEWS - VIDEO FIX EDITION</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@700;900&display=swap');
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Noto Sans Devanagari', sans-serif; }
        #reporter-video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1; background: #000; }
        .ui-overlay { position: relative; width: 100%; height: 100%; z-index: 10; display: flex; flex-direction: column; justify-content: flex-end; pointer-events: none; }
        .breaking-tag { position: absolute; top: 40px; left: 0; background: #cc0000; color: #fff; padding: 15px 40px; font-size: 45px; font-weight: 900; border-right: 10px solid #ffcc00; }
        .rep-label { position: absolute; bottom: 260px; left: 30px; background: rgba(0,0,0,0.8); color: #ffcc00; padding: 10px 30px; font-size: 28px; border-left: 8px solid #ffcc00; }
        .headline-box { width: 100%; background: linear-gradient(to top, #000 90%, transparent); padding: 50px 20px; border-top: 10px solid #ffcc00; box-sizing: border-box; }
        .headline-text { color: #fff; font-size: 52px; text-align: center; margin: 0; font-weight: 700; line-height: 1.3; text-shadow: 3px 3px 10px #000; }
        #start-btn { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; color: #ffcc00; text-align: center; }
    </style>
</head>
<body>

    <div id="start-btn" onclick="startEngine()">
        <h1 style="font-size: 60px; margin: 0;">PTN LIVE STUDIO</h1>
        <p style="color: white; font-size: 24px;">[ NEWS ENGINE SHURU KAREIN ]</p>
    </div>

    <video id="reporter-video" muted playsinline></video>

    <div class="ui-overlay">
        <div class="breaking-tag">LIVE REPORTING</div>
        <div id="rep-info" class="rep-label">Connecting...</div>
        <div class="headline-box">
            <p id="news-text" class="headline-text">Wait, loading video...</p>
        </div>
    </div>

    <script>
        let newsQueue = [];
        let currentIndex = 0;
        const videoPlayer = document.getElementById('reporter-video');
        
        // ðŸ›‘ Yahan apna URL paste karein
        const apiURL = "YAHAN_APNA_WEB_APP_URL_PASTE_KAREIN"; 

        // Google Drive link converter function
        function getDirectVideoLink(url) {
            if (url.includes('drive.google.com')) {
                let fileId = "";
                if (url.includes('/d/')) {
                    fileId = url.split('/d/')[1].split('/')[0];
                } else if (url.includes('id=')) {
                    fileId = url.split('id=')[1].split('&')[0];
                }
                // Ye link video player ko direct stream deta hai
                return `https://www.driveplayer.com/render?id=${fileId}`;
            }
            return url;
        }

        async function fetchNews() {
            try {
                const response = await fetch(apiURL);
                const data = await response.json();
                if (data && data.length > 0) { newsQueue = data; }
            } catch (e) { console.error("Fetch Error"); }
        }

        function playNext() {
            if (newsQueue.length === 0) { fetchAndStart(); return; }

            const current = newsQueue[currentIndex];
            document.getElementById('news-text').innerText = current.text;
            document.getElementById('rep-info').innerText = "Reporter: " + current.reporter;

            // Converter use karein
            const directLink = getDirectVideoLink(current.videoUrl);
            videoPlayer.src = directLink;
            videoPlayer.play().catch(e => console.log("Play failed, waiting for user click"));

            window.speechSynthesis.cancel();
            const speech = new SpeechSynthesisUtterance("Badi khabar... " + current.text);
            speech.lang = 'hi-IN';
            speech.rate = 0.9;

            speech.onend = () => {
                setTimeout(() => {
                    currentIndex = (currentIndex + 1) % newsQueue.length;
                    fetchNews().then(playNext);
                }, 4000);
            };
            window.speechSynthesis.speak(speech);
        }

        async function fetchAndStart() {
            await fetchNews();
            if (newsQueue.length > 0) playNext();
            else {
                document.getElementById('news-text').innerText = "No approved news found!";
                setTimeout(fetchAndStart, 5000);
            }
        }

        function startEngine() {
            document.getElementById('start-btn').style.display = 'none';
            fetchAndStart();
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>PTN NEWS - CLOUDINARY LIVE</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@700;900&display=swap');
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Noto Sans Devanagari', sans-serif; }
        
        /* ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§™‡•ç‡§≤‡•á‡§Ø‡§∞ */
        #reporter-video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1; background: #000; }

        /* ‡§ì‡§µ‡§∞‡§≤‡•á ‡§°‡§ø‡•õ‡§æ‡§á‡§® */
        .ui-overlay { position: relative; width: 100%; height: 100%; z-index: 10; display: flex; flex-direction: column; justify-content: flex-end; pointer-events: none; }
        .breaking-tag { position: absolute; top: 40px; left: 0; background: #cc0000; color: #fff; padding: 15px 40px; font-size: 45px; font-weight: 900; border-right: 10px solid #ffcc00; box-shadow: 10px 10px 30px rgba(0,0,0,0.5); }
        .rep-label { position: absolute; bottom: 270px; left: 30px; background: rgba(0,0,0,0.85); color: #ffcc00; padding: 12px 35px; font-size: 30px; border-left: 8px solid #ffcc00; border-radius: 5px; }
        .headline-box { width: 100%; background: linear-gradient(to top, rgba(0,0,0,1) 85%, transparent); padding: 60px 20px; border-top: 10px solid #ffcc00; box-sizing: border-box; }
        .headline-text { color: #fff; font-size: 55px; text-align: center; margin: 0; font-weight: 900; line-height: 1.3; text-shadow: 4px 4px 15px #000; }

        #start-btn { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, #222, #000); z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; color: #ffcc00; }
    </style>
</head>
<body>

    <div id="start-btn" onclick="startEngine()">
        <h1 style="font-size: 70px; margin: 0; letter-spacing: 5px;">PTN NEWS</h1>
        <p style="color: white; font-size: 24px; margin-top: 20px; border: 2px solid #ffcc00; padding: 10px 30px;">[ ‡§¨‡•ç‡§∞‡•â‡§°‡§ï‡§æ‡§∏‡•ç‡§ü ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç ]</p>
    </div>

    <video id="reporter-video" muted playsinline preload="auto"></video>

    <div class="ui-overlay">
        <div class="breaking-tag">LIVE REPORTING</div>
        <div id="rep-info" class="rep-label">‡§ï‡§®‡•á‡§ï‡•ç‡§ü‡§ø‡§Ç‡§ó...</div>
        <div class="headline-box">
            <p id="news-text" class="headline-text">‡§ñ‡§¨‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•á‡§Ç...</p>
        </div>
    </div>

    <script>
        let newsQueue = [];
        let currentIndex = 0;
        const videoPlayer = document.getElementById('reporter-video');
        
        // üõë ‡§Ö‡§™‡§®‡§æ WEB APP URL ‡§Ø‡§π‡§æ‡§Å ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç
        const apiURL = "https://script.google.com/macros/s/AKfycbxdC0A-qyh_zT4zIcXWsWoCpNfkooytB-B0z3UXTWyWDqseUVHZOd6iQIweMx4vI0GfZA/exec"; 

        async function fetchNews() {
            try {
                const response = await fetch(apiURL);
                const data = await response.json();
                if (data && data.length > 0) {
                    newsQueue = data;
                }
            } catch (e) { console.error("Fetch Error"); }
        }

        function playNext() {
            if (newsQueue.length === 0) {
                fetchAndStart();
                return;
            }

            const current = newsQueue[currentIndex];
            document.getElementById('news-text').innerText = current.text;
            document.getElementById('rep-info').innerText = "‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü‡§∞: " + current.reporter;

            // Cloudinary ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ï‡•ã ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ
            videoPlayer.src = current.videoUrl;
            videoPlayer.load();
            
            // ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§™‡•ç‡§≤‡•á ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§π‡•Ä AI ‡§¨‡•ã‡§≤‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á
            videoPlayer.play().then(() => {
                startSpeech(current.text);
            }).catch(e => {
                console.log("Play failed, skipping to speech...");
                startSpeech(current.text);
            });
        }

        function startSpeech(text) {
            window.speechSynthesis.cancel();
            const speech = new SpeechSynthesisUtterance("‡§¨‡§°‡§º‡•Ä ‡§ñ‡§¨‡§∞... " + text);
            speech.lang = 'hi-IN';
            speech.rate = 0.85;

            speech.onend = () => {
                setTimeout(() => {
                    currentIndex = (currentIndex + 1) % newsQueue.length;
                    fetchNews().then(playNext);
                }, 4000); // 4 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§ï‡§æ ‡§¨‡•ç‡§∞‡•á‡§ï ‡§ñ‡§¨‡§∞ ‡§ï‡•á ‡§¨‡§æ‡§¶
            };
            window.speechSynthesis.speak(speech);
        }

        async function fetchAndStart() {
            await fetchNews();
            if (newsQueue.length > 0) playNext();
            else {
                document.getElementById('news-text').innerText = "‡§ï‡•ã‡§à ‡§Ö‡§™‡•ç‡§∞‡•Ç‡§µ‡•ç‡§° ‡§ñ‡§¨‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä!";
                setTimeout(fetchAndStart, 5000);
            }
        }

        function startEngine() {
            document.getElementById('start-btn').style.display = 'none';
            fetchAndStart();
        }
    </script>
</body>
</html>
